"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}function mergeOptions(e,t){var r=Object.assign({},e);return Object.keys(t).forEach(function(e){return r[e]=t[e]}),r}function Confit(e){this.options=e}function createInstance(e){return new Confit(e)}var axios=_interopDefault(require("axios"));Confit.prototype.load=function(e){var t=mergeOptions(this.options,e||{}),r="/repo/"+t.repoId;t.alias?r+="/alias/"+t.alias:t.path&&(r+="/path/"+t.path);var n={method:"get",url:t.serverUrl+r,headers:t.repoSecret?{Authorization:"token "+t.repoSecret}:void 0};return t.ref&&(n.params={ref:t.ref}),axios(n).then(function(e){return e.data}).catch(function(e){throw e.response?new Error("Confit call failed with status: "+e.response.status+"\nwhile sending request: "+JSON.stringify(n)+"\ndata: "+JSON.stringify(e.response.data)):e.request?new Error("No response from confit server"):new Error("Axios error: "+e.message+"\nwhile forming request: "+JSON.stringify(n))})};var nodeEnv="undefined"==typeof process?{}:process.env,defaults={serverUrl:nodeEnv.CONFIT_HOST||"https://confit.skillbill.net/api",repoSecret:nodeEnv.CONFIT_REPO_SECRET,repoId:nodeEnv.CONFIT_REPO_ID},confit=createInstance(defaults);confit.create=function(e){return new Confit(mergeOptions(defaults,e||{}))},module.exports=confit;
